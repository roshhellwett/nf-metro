%%metro title: RNA-seq Lite
%%metro style: dark
%%metro line: star | STAR + Salmon | #2db572
%%metro line: hisat | HISAT2 | #f5c542
%%metro line: pseudo | Pseudo-alignment | #e63946

graph LR
    subgraph preprocessing [Pre-processing]
        input[Input]
        fastqc_raw[FastQC]
        fastp[FastP]
        trimgalore[Trim Galore!]
        fastqc_trim[FastQC]
        filter[SortMeRNA]
        fastqc_filt[FastQC]

        input -->|star,hisat,pseudo| fastqc_raw
        fastqc_raw -->|star,hisat,pseudo| fastp
        fastqc_raw -->|star,hisat,pseudo| trimgalore
        fastp -->|star,hisat,pseudo| fastqc_trim
        trimgalore -->|star,hisat,pseudo| fastqc_trim
        fastqc_trim -->|star,hisat,pseudo| filter
        filter -->|star,hisat,pseudo| fastqc_filt
    end

    subgraph genome_align [Genome alignment]
        star_align[STAR]
        hisat_align[HISAT2]
        umi_dedup[UMI-tools dedup]
        salmon_quant[Salmon]
        rsem_quant[featureCounts]

        star_align -->|star| umi_dedup
        hisat_align -->|hisat| umi_dedup
        umi_dedup -->|star| salmon_quant
        umi_dedup -->|hisat| rsem_quant
    end

    subgraph pseudo_align [Pseudo-alignment]
        salmon_pseudo[Salmon]
        tximport[tximport]
        summarized_exp[Sum. Exp.]

        salmon_pseudo -->|pseudo| tximport
        tximport -->|pseudo| summarized_exp
    end

    subgraph postprocessing [Post-processing]
        samtools[SAMtools]
        picard[Picard]
        bedtools[BEDTools]
        bigwig[bedGraphToBigWig]

        samtools -->|star,hisat| picard
        picard -->|star,hisat| bedtools
        bedtools -->|star,hisat| bigwig
    end

    subgraph qc_report [QC & Reporting]
        rseqc[RSeQC]
        dupradar[dupRadar]
        featurecounts[featureCounts]
        multiqc[MultiQC]

        rseqc -->|star,hisat| dupradar
        dupradar -->|star,hisat| featurecounts
        featurecounts -->|star,hisat| multiqc
    end

    fastqc_filt -->|star| star_align
    fastqc_filt -->|hisat| hisat_align
    fastqc_filt -->|pseudo| salmon_pseudo
    salmon_quant -->|star| samtools
    rsem_quant -->|hisat| samtools
    bigwig -->|star,hisat| rseqc
